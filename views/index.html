<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Single page web app using Angularjs</title>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.3/angular.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.3/angular-route.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2.5.13/dist/vue.js"></script>
<script src="https://cdn.jsdelivr.net/npm/pw-app-sdk@0.1.2/dist/pwsdk.min.js"></script>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

</head>
<body>
	<script>

		var person = {
			email : 'billmcpherson87@gmail.com'
		};

		var zenCard;
		var red = '#B22222';
		var teal = '#46B6AC';
		try {
			var sdk = PWSDK.init();
		} catch(err) {
			console.log(err);	
		}


		$(function() {
			if (sdk) {
				sdk.setAppUI({height: 1000});
				sdk.getContext().then(function(data) {
					console.log(data.context);
				});
			}
			
			zenCard = new Vue({
				el: '#zenCard',
				data: {
				items: [
					]
				}
			})

			function capitalizeFirstLetter(string) {
				return string.charAt(0).toUpperCase() + string.slice(1);
			}

			$("button").on("click", function () {
				$.ajax({
				type: 'GET',
				dataType: 'json',
				data: person,
				url: '/zeninfo',
				success: function(result) {

					$.each(result, function(index){
						var p = capitalizeFirstLetter(result[index].priority);
						var t = capitalizeFirstLetter(result[index].type);
						var s;
						if(p == 'Urgent'){
							s = 'mdl-card__title mdl-card--expand mdl-card__title-red';
						} else {
							s = 'mdl-card__title mdl-card--expand';
						}
						zenCard.items.push({
							subject : result[index].raw_subject, 
							priority : p, 
							url : result[index].url, 
							st : s,
							type : t
						});

					});
				}
				});
			});
		});

	</script>

	<button>Display Ticket Info</button>

	<!-- Square card -->
	<style>
		.demo-card-square.mdl-card {
		  width: 250px;
		  height: 250px;
		}
		.mdl-card__title-teal {
		  color: #fff;
		  background-color: #46B6AC;
		}
		.mdl-card__title-red {
		  background-color: #B22222 !important;
		}
		.mdl-card__title-black {
		  background-color: #000000 !important;
		}
		.mdl-card__menu {
	  		color: #fff;
		}

		.demo-card-square > .mdl-card__title {
			color: #fff;
			background:
			url('../assets/demos/dog.png') bottom right 15% no-repeat #46B6AC;
		}
	</style>
	
	<ul style="list-style: none;" id="zenCard">
		<li v-for="item in items">
			<div class="demo-card-square mdl-card mdl-shadow--2dp">
				<div class="mdl-card__menu">
					<img src="/icons/zendesk.png" style="width:30px; height:30px;"></img>
				</div>
				<div v-bind:class="item.st">
				    <h2 class="mdl-card__title-text">{{item.subject}}</h2>
				</div>
				<div class="mdl-card__supporting-text">
					<span style="font-weight: bold">Priority: </span>
					<span>{{ item.priority }}</span>
				</div>
				<div class="mdl-card__supporting-text">
					<span style="font-weight: bold">Type: </span>
					<span>{{item.type}}</span>
				</div>
<!-- 

				<div class="mdl-card__actions mdl-card--border">
				    <a v-bind:href="item.url" class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">
				      View Updates
				    </a>
			  	</div> -->
			</div>
		</li>
	</ul>
</body>
</html>




